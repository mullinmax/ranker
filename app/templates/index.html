{% extends "base.html" %}
{% block title %}Rank Media{% endblock %}
{% block content %}
{% if file %}
<div class="media-container">
  <img class="media-preview" src="/media/{{file}}" alt="media" />
  {% if last_ranked %}
  <span class="last-ranked{% if last_ranked_today %} today{% endif %}">last ranked: {{ last_ranked }}</span>
  {% endif %}
</div>
<form id="rate-form" action="/rate" method="post">
  <input type="hidden" id="file" name="file" value="{{file}}" />
  <input type="hidden" id="score" name="score" />
  {% for i in range(1,6) %}
    <button type="button" onclick="rate({{i}})">{{i}}</button>
  {% endfor %}
</form>
{% else %}
<p>No media files found</p>
{% endif %}
<script>
document.addEventListener('keydown', function(e) {
  const key = e.key;
  if (['1','2','3','4','5'].includes(key)) {
    document.getElementById('score').value = key;
    document.getElementById('rate-form').submit();
  }
});
function rate(val) {
  document.getElementById('score').value = val;
  document.getElementById('rate-form').submit();
}
</script>
{% endblock %}
